<div class="main-content">

    <!-- Liste des posts -->
    <div class="posts-section">

      <div class="group-header">
        <img [src]="groupData.imagePath" class="group-image" alt="Groupe">
      
        <div class="group-info">
          <div class="group-header-top">
            <h1 class="group-title">{{ groupData.name || "Inconnu" }}</h1>
            <button 
              class="join-group-button" 
              (click)="joinGroup()" 
              [disabled]="hasJoinedGroup">
              <span *ngIf="hasJoinedGroup">Rejoint ‚úî</span>
              <span *ngIf="!hasJoinedGroup">Rejoindre le groupe</span>
            </button>
          </div>
          <h2 class="group-description">{{ groupData.description || "Inconnu" }}</h2>
        </div>
      </div>      

      <!-- Bouton de toggle pour afficher/masquer le formulaire -->
      <button (click)="toggleCreatePost()" class="toggle-post-button">
        <span>{{ showCreatePost ? 'Masquer le formulaire' : 'Cr√©er un nouveau post' }}</span>
        <span [ngClass]="{ 'arrow-up': showCreatePost, 'arrow-down': !showCreatePost }">‚ñº</span>
      </button>

      <!-- Zone de cr√©ation de post -->
      <div class="create-post-section" *ngIf="showCreatePost">
        <h2>Cr√©er un nouveau post</h2>
        
        <input type="text" [(ngModel)]="newPost.title" class="input-title" placeholder="Titre du post">
        
        <textarea [(ngModel)]="newPost.text" class="input-text" placeholder="Contenu du post"></textarea>
        
        <input type="file" (change)="onMediaSelected($event)" accept="image/*,video/*" class="input-media">
        <!-- Pr√©visualisation du m√©dia -->
        <div class="media-preview" *ngIf="mediaPreviewUrl">
          <img *ngIf="isImage" [src]="mediaPreviewUrl" alt="Aper√ßu de l'image" class="preview-image">
          <video *ngIf="!isImage" [src]="mediaPreviewUrl" controls class="preview-video"></video>
        </div>
        
        <input type="text" [(ngModel)]="newPost.location" class="input-location" placeholder="Lieu">
        
        <!-- Message d'erreur -->
        <div *ngIf="errorMessage" class="error-message">
          {{ errorMessage }}
        </div>
        
        <button (click)="submitPost()" class="submit-post-button">Publier</button>
      </div>

      <div *ngFor="let post of postData" class="post-card">
        <div class="post-header">
          <div>
            <span class="post-author">{{ post.author }}</span>
            <span class="post-timestamp">{{ post.datetime }}</span>
          </div>
          <span class ='post-location'>{{ post.location }}</span>
        </div>
        <h2 class="post-title">{{ post.title }}</h2>
        <p class="post-text">{{ post.text }}</p>
        <img *ngIf="post.media" [src]="post.media" alt="Post media" class="post-media">
        <div class="post-actions">
          <button class="action-button">‚ù§Ô∏è {{ post.likes || 0 }}</button>
          <button class="action-button">üí¨ {{ post.comments || 0 }}</button>
        </div>
      </div>

       <div *ngIf="!postData || postData.length === 0" class="empty-state">
        Aucun post pour le moment, soyez le premier √† commenter !
      </div>

    </div>
  
    <!-- Sidebar des membres -->
    <div class="groups-sidebar">
      <input 
        type="text" 
        class="searchBar" 
        placeholder="Rechercher une personne" 
        [(ngModel)]="searchQuery" 
        (input)="onSearchChange()"
      >
      <h2 class="members-title">
        Membres
        <button 
          *ngIf="hasJoinedGroup" 
          class="leave-group-button" 
          (click)="leaveGroup()">
          Quitter le groupe
        </button>
      </h2>
      <div *ngIf="filteredMembers.length > 0; else noResults">
        <div *ngFor="let member of filteredMembers" class="member-item">
          <img [src]="member.logo" class="member-image" alt="{{ member.logo }}">
          <div>
            <h3 class="member-name">{{ member.username }}</h3>
            <p class="member-activity">{{ member.lastActivity }}</p>
          </div>
        </div>
      </div>
      <ng-template #noResults>
        <p class="no-results">Aucun membre trouv√©.</p>
      </ng-template>
    </div>
</div>
